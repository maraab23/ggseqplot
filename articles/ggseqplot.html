<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ggseqplot">
<title>Introduction to ggseqplot • ggseqplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Poppins-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ggseqplot">
<meta property="og:description" content="ggseqplot">
<meta property="og:image" content="https://maraab23.github.io/ggseqplot/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ggseqplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ggseqplot.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/RaabM" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/maraab23/ggseqplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to ggseqplot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maraab23/ggseqplot/blob/HEAD/vignettes/ggseqplot.Rmd" class="external-link"><code>vignettes/ggseqplot.Rmd</code></a></small>
      <div class="d-none name"><code>ggseqplot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="prelude">Prelude<a class="anchor" aria-label="anchor" href="#prelude"></a>
</h2>
<p>Following Fasang and Liao <span class="citation">(2014)</span>, we
distinguish between sequence representation and summarization graphs.
The latter aggregate and summarize the information stored in the
sequence data without plotting actual observed sequences. Given the
complexity of sequence data, these type of plots focus on one or two
dimensions of information stored in sequence data <span class="citation">(Brzinsky-Fay, 2014)</span>. Among the diverse members
of the family of summarization graphs are sequence transitions plot,
Kaplan-Meier survival curves, modal state plots, mean time plots, state
distribution plots, and entropy plots <span class="citation">(Fasang
&amp; Liao, 2014; Raab &amp; Struffolino, 2022)</span>.</p>
<p><a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
includes five summarization graphs:</p>
<ul>
<li>state distribution plots (<code>ggseqdplot</code>)</li>
<li>entropy line plots (<code>ggseqplot</code>)</li>
<li>modal state sequence plot (<code>ggseqmsplot</code>)</li>
<li>mean time plot (<code>ggseqmtplot</code>)</li>
<li>transition rate plots (<code>ggseqtrplot</code>)</li>
</ul>
<p>Whereas summarization graphs aggregate the sequence data,
representation plots always display actually observed sequences. In the
most basic form of the traditional sequence index plot all observed
sequences are displayed. In data sets with several hundred cases this
kind of visualization, however, cannot be reasonably applied because of
the issue of overplotting. In such a scenario individual sequences are
partly plotted on top of each other and the resulting graph would be an
inaccurate representation of the underlying sequence data. In response
to this issue alternative representation plots which only render a
subset of the sequences have been suggested. <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
allows to render both the traditional sequence index plots and
representation plots of subsets of sequences. Specifically, the library
contains the following plot types:</p>
<ul>
<li>sequence index plot (<code>ggseqiplot</code>)</li>
<li>sequence frequency plot (<code>ggseqfplot</code>)</li>
<li>representative sequence plot (<code>ggseqrplot</code>)</li>
<li>relative frequency sequence plot (<code>ggseqrfplot</code>)</li>
</ul>
<p>For a more detailed discussion of sequence visualization I recommend
the following articles/book chapters: Brzinsky-Fay <span class="citation">(2014)</span>, Fasang and Liao <span class="citation">(2014)</span> and Chapter 2 of Raab &amp; Struffolino
<span class="citation">(2022)</span>.</p>
<p>With the exception of the transition rate plot all of the plots
listed above can be also produced with <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a>. In total, those two
libraries provide a much more comprehensive set of plots and often allow
for more options than {ggseqplot}. Hence, if you are an experienced user
base R’s <code>plot</code> (which is used to render the <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> plots), there is no real
need to make yourself acquainted with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>.</p>
<p><a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
was written because like many other R users I prefer <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> to base R’s <code>plot</code>
environment for visualizing data. <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> <span class="citation">(Gabadinho et al., 2011)</span> was developed before <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> <span class="citation">(Wickham, 2016)</span> was as popular as it is today
and back then many users were more familiar with coding base R plots. To
date, however, many researchers and students are more accustomed to
using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> and prefer to draw on the
related skills and experiences instead of learning how to refine base R
plots just for the single purpose of visualizing sequence data.</p>
<p>This vignette outlines how sequence data generated with
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">TraMineR::seqdef</a></code> are reshaped to plot them as ggplot2-typed
figures using <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>.
More specifically, it gives an overview of the general procedure and
depicts which <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> and <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions are used to render
the plots</p>
<p>The vignette further illustrates how the appearance of plots produced
with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
can be changed using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions and extensions.</p>
</div>
<div class="section level2">
<h2 id="setup-example">Setup example<a class="anchor" aria-label="anchor" href="#setup-example"></a>
</h2>
<p>We start by loading the required libraries and defining the sequence
data to be plotted. We draw in the examples from the <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> for setting up the
examples.</p>
<p><br></p>
<details><summary><strong>Click to see code for installing and loading required
packages</strong>
</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Load and download (if necessary) required packages ----</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span></span>
<span></span>
<span><span class="co">## Save package names as a vector of strings</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colorspace"</span>, <span class="st">"ggplot2"</span>, <span class="st">"ggthemes"</span>, <span class="st">"hrbrthemes"</span>, </span>
<span>          <span class="st">"patchwork"</span>, <span class="st">"purrr"</span>, <span class="st">"TraMineR"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Install uninstalled packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">pkgs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       <span class="va">install.packages</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">[</span><span class="st">"CRAN"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Load all packages to library and adjust options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Don't forget to load ggseqplot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://maraab23.github.io/ggseqplot/">ggseqplot</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Creating state sequence objects from example data sets ----</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span></span>
<span><span class="co">## biofam data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biofam</span><span class="op">)</span></span>
<span></span>
<span><span class="va">biofam.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parent"</span>, <span class="st">"Left"</span>, <span class="st">"Married"</span>, <span class="st">"Left+Marr"</span>,</span>
<span>                <span class="st">"Child"</span>, <span class="st">"Left+Child"</span>, <span class="st">"Left+Marr+Child"</span>, <span class="st">"Divorced"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">biofam.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">biofam</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span>, <span class="op">]</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">25</span>, <span class="co"># we only use a subsample</span></span>
<span>                     labels <span class="op">=</span> <span class="va">biofam.lab</span>,</span>
<span>                     weights <span class="op">=</span> <span class="va">biofam</span><span class="op">$</span><span class="va">wp00tbgs</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## actcal data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">actcal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actcal.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&gt; 37 hours"</span>, <span class="st">"19-36 hours"</span>, <span class="st">"1-18 hours"</span>, <span class="st">"no work"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actcal.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">actcal</span>,<span class="fl">13</span><span class="op">:</span><span class="fl">24</span>,</span>
<span>                     labels<span class="op">=</span><span class="va">actcal.lab</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ex1 data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">)</span></span>
<span><span class="va">ex1.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">ex1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">13</span>, </span>
<span>                  weights<span class="op">=</span><span class="va">ex1</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span></code></pre></div>
<p>Note that the default figure size in this document is specified as:
<code>fig.width=8, fig.height=4.94</code></p>
</div>
<div class="section level2">
<h2 id="technicalities">Technicalities<a class="anchor" aria-label="anchor" href="#technicalities"></a>
</h2>
<p>In general, all <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions operate in the similar way: they extract the data to be
plotted using a state sequence object generated with
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">TraMineR::seqdef</a></code> as a staring point. The functions either
simply use (a subset of) the sequence data stored in this object or call
other <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> functions such as
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code> to obtain the information to be plotted.
Under the hood <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
reshapes those data to visualize them using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions. Usually this means
that the data have to be reshaped into a long (tidy) format.</p>
<p>The following example illustrates the procedure for the case of a
state distribution plot. The cross-sectional state distributions across
the positions of the sequence data can be obtained by:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">seqstatd</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [State frequencies]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; A 0.421 0.420 0.421 0.417 0.419  0.42  0.42  0.42  0.42 0.418 0.414 0.415</span></span>
<span><span class="co">#&gt; B 0.162 0.162 0.162 0.162 0.162  0.16  0.16  0.17  0.17 0.169 0.170 0.171</span></span>
<span><span class="co">#&gt; C 0.098 0.098 0.098 0.097 0.097  0.10  0.10  0.10  0.10 0.096 0.096 0.098</span></span>
<span><span class="co">#&gt; D 0.320 0.321 0.320 0.324 0.322  0.32  0.32  0.31  0.31 0.318 0.320 0.317</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    [Valid states]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; N  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    [Entropy index]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; H   0.9   0.9   0.9   0.9   0.9   0.9   0.9  0.91  0.91   0.9  0.91  0.91</span></span></code></pre></div>
<p>When calling <code>ggseqdplot</code> these distributional data are
reshaped into a long data set in which every row stores the (weighted)
relative frequency of a given state at a given position along the
sequence. The example data <code>actcal.seq</code> contain sequences of
length 12 with an alphabet comprising 4 states. The reshaped data
serving as source for the <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> call thus contain <span class="math inline">\(12\times4=48\)</span> rows. If a group vector is
specified, the respective data will comprise 48 rows for each group. The
data set produced by <code>ggseqdplot</code> can be accessed if the
function’s output is assigned to an object. The resulting list object
stores the data as its first element (named <code>data</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span>
<span><span class="va">dplot</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 6</span></span></span>
<span><span class="co">#&gt;    group state      k     x     value grouplab           </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1     &gt; 37 hours jan00 1     0.421 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1     &gt; 37 hours feb00 2     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1     &gt; 37 hours mar00 3     0.422 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1     &gt; 37 hours apr00 4     0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1     &gt; 37 hours may00 5     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1     &gt; 37 hours jun00 6     0.42  Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1     &gt; 37 hours jul00 7     0.422 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1     &gt; 37 hours aug00 8     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1     &gt; 37 hours sep00 9     0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1     &gt; 37 hours oct00 10    0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span></code></pre></div>
<p>Once the data are in the right shape <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions produce graphs using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions. In the case of the
state distribution plot, for instance, <code>ggseqdplot</code> renders
stacked bar charts for each sequence position using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>.</p>
<p>The following table gives an overview of the most important internal
function calls used to render different plot types with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a></p>
<table class="table">
<colgroup>
<col width="20%">
<col width="22%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th>ggseqplot function</th>
<th>TraMineR function</th>
<th>ggplot2 geoms and extensions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>ggseqdplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code></td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code><br>optional:
<code>geom_line</code>
</td>
</tr>
<tr class="even">
<td><code>ggseqeplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code></td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line</a></code></td>
</tr>
<tr class="odd">
<td><code>ggseqmsplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqmodst.html" class="external-link">TraMineR::seqmodst</a></code></td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code></td>
</tr>
<tr class="even">
<td><code>ggseqmtplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqmeant.html" class="external-link">TraMineR::seqmeant</a></code></td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code></td>
</tr>
<tr class="odd">
<td><code>ggseqtrplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code></td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile</a></code></td>
</tr>
<tr class="even">
<td><code>ggseqiplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqformat.html" class="external-link">TraMineR::seqformat</a></code></td>
<td><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code></td>
</tr>
<tr class="odd">
<td><code>ggseqfplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">TraMineR::seqtab</a></code></td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><a href="https://teunbrand.github.io/ggh4x/" target="_blank" class="external-link"><code>{ggh4x}</code></a> (for the axis labeling if group
has been specified)</td>
</tr>
<tr class="even">
<td><code>ggseqrplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqrep.html" class="external-link">TraMineR::seqrep</a></code></td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code><br><a href="https://wilkelab.org/ggtext/" target="_blank" class="external-link"><code>{ggtext}</code></a> (for optional colored axis
labels)<br><a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> (to combine plots)</td>
</tr>
<tr class="odd">
<td><code>ggseqrfplot</code></td>
<td><code><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">TraMineR::seqrfplot</a></code></td>
<td>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">ggplot2::geom_boxplot</a></code><br><a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> (to combine plots)</td>
</tr>
</tbody>
</table>
<p>The appearance of most of the plots generated with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
can be adjusted just like every other ggplot (e.g., by changing the
theme or the scale using <code>+</code> and the respective functions).
Representative sequence plots and relative frequency sequence plots,
however, behave differently because they are composed of multiple plots
which are arranged by the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library. The following
section illustrates how the appearance of the plots can be changed</p>
</div>
<div class="section level2">
<h2 id="changing-the-appearance-of-plots">Changing the appearance of plots<a class="anchor" aria-label="anchor" href="#changing-the-appearance-of-plots"></a>
</h2>
<div class="section level3">
<h3 id="the-default-case">The default case<a class="anchor" aria-label="anchor" href="#the-default-case"></a>
</h3>
<p>As mentioned above, most plots rendered by <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
are of class <code>c("gg", "ggplot")</code> and can be adjusted just
like other plots rendered with <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a></p>
<div class="section level4">
<h4 id="example-1-state-distribution-plot">Example 1: State distribution plot<a class="anchor" aria-label="anchor" href="#example-1-state-distribution-plot"></a>
</h4>
<p>In our first example we illustrate this for state distribution plot.
We start with the most basic version of the plot visualizing the state
distributions of <code>actcal.seq</code> without changing any of the
defaults.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ggseqplot::ggseqdplot</span></span>
<span><span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/dplot1-1.png" width="768"></p>
<p>We proceed by illustrating how <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions &amp; extensions
can be used to refine the default outcome. Just like every other <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> figure the appearance of
plots generated with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions can be dramatically changed with a few adjustments:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_discrete_sequential</span><span class="op">(</span><span class="st">"heat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"State distribution plot"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Alphabet"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_ipsum</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="co"># ensures that this works on different OS</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>, </span>
<span>                                  margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">20</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        plot.title.position <span class="op">=</span> <span class="st">"plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-1-1.png" width="768"></p>
<p>In the following example we again illustrate a few <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions &amp; extensions by
composing a figure comprising two plots produced with
<code>ggseqdplot</code>. Both visualize the same data but only the first
plot considers weights. In addition to state distributions the plots
display the accompanying entropies as line plot
(<code>geom_line</code>). Finally, the plots are brought together using
the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library <span class="citation">(Pedersen, 2020)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save plot using weights</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, </span>
<span>                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Weighted data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save same plot without using weights</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, </span>
<span>                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unweighted data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arrange and refine plots using patchwork</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span> <span class="va">canva_palettes</span><span class="op">$</span><span class="va">`Fun and tropical`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">theme_ipsum</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-2-transition-rate-plot">Example 2: Transition rate plot<a class="anchor" aria-label="anchor" href="#example-2-transition-rate-plot"></a>
</h4>
<p>The second set of examples illustrates how to refine a figure of
combined transition rate plots. <code>ggseqtrplot</code> calls
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code> to obtain the transition rates between
the states of the alphabet. <code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code> stores these
rates in a symmetrical matrix which internally is reshaped into a long
format with one row for every combination of states (i.e., the squared
size of the sequence alphabet) by <code>ggseqdplot</code>. The reshaped
data are the input for a <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> call using
<code>geom_tile</code>.</p>
<p>We start with a simple example that only takes the sequence data and
the group argument as inputs. The output is a faceted plot visualizing
two transition rate matrices of DSS sequence data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, </span>
<span>            group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>In the second example we specify additional arguments and utilize
once again the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library to compose a figure
that compares the transition matrices of sequence stored in the STS and
the DSS format.</p>
<p>We use <code>x_n.dodge = 2</code> to prevent overlapping of the state
labels of the x-axis, slightly reduce the labels size of the value
labels displayed within the tiles, and use <code>dss = FALSE</code> to
compute and display the transition rates of the STS sequences.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, </span>
<span>                  dss <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  labsize <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"STS Sequences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, </span>
<span>                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  labsize <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"DSS Sequences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>Other than the grouped version of the plot this composed figure
contains the y-axis title and labels twice. This can be changed with
small adjustments of the corresponding <code>theme</code> arguments.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-3-flipping-coordinates">Example 3: Flipping coordinates<a class="anchor" aria-label="anchor" href="#example-3-flipping-coordinates"></a>
</h4>
<p>We conclude this section by illustrating that it is also possible to
flip the coordinates of the plots rendered by <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>,
a procedure that is widely used in the <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> universe (although the
coordinates could also be swapped in the <code>aes(x, y, ...)</code>
specification).</p>
<p>In the example below we illustrate the procedure for a mean time plot
and a sequence index plot. We always present both, the default plot and
the flipped version:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## default plot</span></span>
<span><span class="fu"><a href="../reference/ggseqmtplot.html">ggseqmtplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, no.n <span class="op">=</span> <span class="cn">TRUE</span>, error.bar <span class="op">=</span> <span class="st">"SE"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## flipped version</span></span>
<span><span class="fu"><a href="../reference/ggseqmtplot.html">ggseqmtplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, no.n <span class="op">=</span> <span class="cn">TRUE</span>, error.bar <span class="op">=</span> <span class="st">"SE"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-6-2.png" width="768"></p>
<p>While in the example above the flipped plot might be in greater
accordance to most people’s aesthetic preferences, flipping the
coordinates in the case of sequence index plots might be a more of an
opinionated design choice. Most scholars prefer to display time on the
horizontal axis. However, if you favor time to <em>run</em> from the
bottom to the top (like in Piccarreta and Lior <span class="citation">(2010)</span>) instead of left to right, your
preferences can be easily met.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## default plot</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, sortv <span class="op">=</span> <span class="st">"from.end"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## flipped version</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, sortv <span class="op">=</span> <span class="st">"from.end"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-7-2.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="the-special-case-of-combined-plots">The special case of combined plots<a class="anchor" aria-label="anchor" href="#the-special-case-of-combined-plots"></a>
</h3>
<p>Two types of plots differ from the other <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions because they are composed by two subplots which are arranged
to a joint figure with the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library. The output of
those functions cannot be changed in the same was as for the other
functions. For details on the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library we recommend the
package’s website.</p>
<div class="section level4">
<h4 id="example-4-annotation-and-themes">Example 4: Annotation and themes<a class="anchor" aria-label="anchor" href="#example-4-annotation-and-themes"></a>
</h4>
<p>Some of the adjustments of a combined <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> plot are pretty similar to
the default <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> procedure. In the example
below we change the theme and add a title to the plot. Note that the
corresponding functions are not added by <code>+</code> but with
<code>&amp;</code> instead.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## compute dissimilarity matrix required for plot</span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">biofam.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 100 sequences with 8 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 8x8 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 76 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 16/16</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.021 secs</span></span>
<span></span>
<span><span class="co">## Relative Frequency Sequence Plot</span></span>
<span><span class="co">## default version</span></span>
<span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> </span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## adjusted version</span></span>
<span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">theme_ipsum</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relative Frequency Sequence Plot"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-8-2.png" width="768"></p>
<p>If you want to manipulate the appearance of a specific plot, however,
your default code might not work. If you want to change the labels of
the index plot, for instance, the following code will <em>not</em>
produce the desired result, because <code>scale_x_discrete</code> will
change the appearance of the boxplot, i.e. the last plot used when
composing the plot with <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>The appearance of the subplots, however, can be changed once you save
the composite plot and then adjust its components.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## save &amp; view original plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## change appearance of sub-plots</span></span>
<span></span>
<span><span class="co">## first component: index plot</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="co">## second component: boxplot</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changed title"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## adjusted plot</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-10-2.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-5-the-complex-case-of-grouped-rplots">Example 5: The complex case of grouped rplots<a class="anchor" aria-label="anchor" href="#example-5-the-complex-case-of-grouped-rplots"></a>
</h4>
<p>Note that things become a little bit more complex in the case of a
grouped representative sequence plot. In such a plot each group
contributes two subplots. One providing information on the “quality” of
the representative sequences, and another one containing the
corresponding index plots. If we want to change the x-axis labels of the
following plot, we have to extract and change the index plots which
appear in the second row of the combined plot. The plots are arranged by
row. Hence the index plots are the subplots 3 and 4</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Compute a pairwise dissimilarity matrix</span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">actcal.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 2000 sequences with 4 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 4x4 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 186 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 12/12</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.341 secs</span></span>
<span></span>
<span><span class="co">## original plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrplot.html">ggseqrplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, </span>
<span>                diss <span class="op">=</span> <span class="va">diss</span>,</span>
<span>                nrep <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] number of objects (sum of weights): 884</span></span>
<span><span class="co">#&gt;  [&gt;] max. distance: 24</span></span>
<span><span class="co">#&gt;  [&gt;] neighborhood radius: 2.4</span></span>
<span><span class="co">#&gt;  [&gt;] 3 representative(s) selected</span></span>
<span><span class="co">#&gt;  [&gt;] 80 distinct sequence(s)</span></span>
<span><span class="co">#&gt;  [&gt;] number of objects (sum of weights): 1116</span></span>
<span><span class="co">#&gt;  [&gt;] max. distance: 24</span></span>
<span><span class="co">#&gt;  [&gt;] neighborhood radius: 2.4</span></span>
<span><span class="co">#&gt;  [&gt;] 3 representative(s) selected</span></span>
<span><span class="co">#&gt;  [&gt;] 144 distinct sequence(s)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## adjusted sequence index subplots</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-11-2.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-6-what-about-grouped-rfplots">Example 6: What about grouped rfplots?<a class="anchor" aria-label="anchor" href="#example-6-what-about-grouped-rfplots"></a>
</h4>
<p>Grouped rfplots are currently not implemented for
<code>ggseqrfplot</code> and have to be created manually using the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library.</p>
<p>In the following example we</p>
<ol style="list-style-type: decimal">
<li>create rfplots for our groups (here “Men” and “Women”), then proceed
by</li>
<li>slightly misusing <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a>’s tag annotation assigning
group-specific tags for the first plot in each row of the final
patchwork plot,</li>
<li>removing the legend from the upper plot panel
(<code>p$man</code>),</li>
<li>and arranging the adjusted patches in a final plot with two stacked
panels.</li>
</ol>
<p>Technically speaking the resulting plot is a nested patchwork plot.
According to the documentation of <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a></p>
<blockquote>
<p>[i]t is important to note that plot annotations only have an effect
on the top-level patchwork. Any annotation added to nested patchworks
are (currently) lost. If you need to have annotations for a nested
patchwork you’ll need to wrap it in wrap_elements() with the side-effect
that alignment no longer works.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html#titles-subtitles-and-captions" class="external-link uri"&gt;https://patchwork.data-imaginist.com/articles/guides/annotation.html#titles-subtitles-and-captions&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
</blockquote>
<p>For this reason the group-specific titles were not added with
<code><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">patchwork::plot_annotation</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::ggtitle</a></code>
and we reverted to the use of tags instead.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">biofam.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 100 sequences with 8 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 8x8 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 76 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 16/16</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.02 secs</span></span>
<span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="va">biofam</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span>, <span class="st">"sex"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">map2</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, <span class="co"># input x</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, <span class="co"># input y</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span><span class="op">[</span><span class="va">sex</span> <span class="op">==</span> <span class="va">x</span>,<span class="op">]</span>,</span>
<span>                     diss <span class="op">=</span> <span class="va">diss</span><span class="op">[</span><span class="va">sex</span> <span class="op">==</span> <span class="va">x</span>,<span class="va">sex</span> <span class="op">==</span> <span class="va">x</span><span class="op">]</span>,</span>
<span>                     k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>tag <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.5448432</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 3.408139, p-value: 0.003407164</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.5263291</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.687386, p-value: 4.537004e-06</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">man</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span><span class="op">$</span><span class="va">woman</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<hr>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-brzinsky-fay2014" class="csl-entry">
Brzinsky-Fay, C. (2014). <em>Graphical Representation of Transitions and
Sequences</em> (P. Blanchard, F. Bühlmann, &amp; J.-A. Gauthier, Eds.;
pp. 265–284). Springer. <a href="https://doi.org/10.1007/978-3-319-04969-4_14" class="external-link">https://doi.org/10.1007/978-3-319-04969-4_14</a>
</div>
<div id="ref-fasang2014" class="csl-entry">
Fasang, A. E., &amp; Liao, T. F. (2014). Visualizing Sequences in the
Social Sciences: Relative Frequency Sequence Plots. <em>Sociological
Methods &amp; Research</em>, <em>43</em>(4), 643–676. <a href="https://doi.org/10.1177/0049124113506563" class="external-link">https://doi.org/10.1177/0049124113506563</a>
</div>
<div id="ref-gabadinho2011" class="csl-entry">
Gabadinho, A., Ritschard, G., Müller, N. S., &amp; Studer, M. (2011).
Analyzing and Visualizing State Sequences in R with TraMineR.
<em>Journal of Statistical Software</em>, <em>40</em>(4), 1–37. <a href="https://doi.org/10.18637/jss.v040.i04" class="external-link">https://doi.org/10.18637/jss.v040.i04</a>
</div>
<div id="ref-pedersen2020" class="csl-entry">
Pedersen, T. L. (2020). <em>Patchwork: The composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork" class="external-link">https://CRAN.R-project.org/package=patchwork</a>
</div>
<div id="ref-piccarreta2010" class="csl-entry">
Piccarreta, R., &amp; Lior, O. (2010). Exploring sequences: A graphical
tool based on multi-dimensional scaling: <span>Exploring
Sequences</span>. <em>Journal of the Royal Statistical Society: Series A
(Statistics in Society)</em>, <em>173</em>(1), 165–184. <a href="https://doi.org/10.1111/j.1467-985X.2009.00606.x" class="external-link">https://doi.org/10.1111/j.1467-985X.2009.00606.x</a>
</div>
<div id="ref-raab2022" class="csl-entry">
Raab, M., &amp; Struffolino, E. (2022). <em>Sequence analysis</em> (Vol.
190). SAGE. <a href="https://sa-book.github.io/" class="external-link">https://sa-book.github.io/</a>
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>
(2nd ed. 2016). Springer. <a href="https://doi.org/10.1007/978-3-319-24277-4" class="external-link">https://doi.org/10.1007/978-3-319-24277-4</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://marcelraab.de" class="external-link">Marcel Raab</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
