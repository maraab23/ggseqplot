<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ggseqplot • ggseqplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Condensed-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ggseqplot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggseqplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ggseqplot.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/maraab23/ggseqplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to ggseqplot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maraab23/ggseqplot/blob/v0.8.8/vignettes/ggseqplot.Rmd" class="external-link"><code>vignettes/ggseqplot.Rmd</code></a></small>
      <div class="d-none name"><code>ggseqplot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="prelude-setup">Prelude &amp; Setup<a class="anchor" aria-label="anchor" href="#prelude-setup"></a>
</h2>
<p>Following Fasang and Liao <span class="citation">(2014)</span>, we
distinguish between <strong>sequence representation</strong> and
<strong>summarization</strong> graphs. Summarization plots aggregate
information from the data without displaying individual sequences. Given
the complexity of sequence data, these plots focus on one or two
dimensions of information stored in sequence data <span class="citation">(Brzinsky-Fay, 2014)</span>. Common examples include
transition plots, Kaplan-Meier curves, modal state plots, mean time
plots, state distribution plots, and entropy plots <span class="citation">(Fasang &amp; Liao, 2014; Raab &amp; Struffolino,
2022)</span>.</p>
<p><a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
includes five types of summarization plots:</p>
<ul>
<li>State distribution plots (<code>ggseqdplot</code>)</li>
<li>Entropy line plots (<code>ggseqplot</code>)</li>
<li>Modal state sequence plot (<code>ggseqmsplot</code>)</li>
<li>Mean time plot (<code>ggseqmtplot</code>)</li>
<li>Transition rate plots (<code>ggseqtrplot</code>)</li>
</ul>
<p>In contrast to summarization plots, representation plots visualize
actually observed sequences. The most basic version is the sequence
index plot, which displays all sequences in the dataset. However, this
approach becomes impractical with large datasets due to
overplotting—individual sequences may overlap, making the visualization
misleading. To address this, alternative representations that display
only a subset of sequences have been proposed.</p>
<p><a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
supports both full and subset-based representation plots, offering the
following plot types:</p>
<ul>
<li>Sequence index plot (<code>ggseqiplot</code>)</li>
<li>Sequence frequency plot (<code>ggseqfplot</code>)</li>
<li>Representative sequence plot (<code>ggseqrplot</code>)</li>
<li>Relative frequency sequence plot (<code>ggseqrfplot</code>)</li>
</ul>
<p>For a deeper discussion of sequence data visualization, see
Brzinsky-Fay <span class="citation">(2014)</span>, Fasang and Liao <span class="citation">(2014)</span> and Chapter 2 of Raab &amp; Struffolino
<span class="citation">(2022)</span>.</p>
<p>With the exception of transition rate plots, all of the plots listed
above can also be produced with <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a>. In fact, <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> typically offers more
customization options—but only through base R’s plotting system. If you
are comfortable using base R graphics, there may be little reason to
switch to <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>.</p>
<p>However, <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
was developed precisely because many R users today prefer <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> to base R’s <code>plot</code>
environment for visualizing data. <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> <span class="citation">(Gabadinho et al., 2011)</span> was developed before <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> <span class="citation">(Wickham, 2016)</span> was as popular as it is today
and back then many users were more familiar with coding base R plots.
Today, most researchers and students are more familiar with <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> and would rather build on
existing skills instead of learning how to refine base R plots just for
sequence visualizations.</p>
<p>This vignette demonstrates how sequence objects created via
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">TraMineR::seqdef</a></code> are reshaped to plot them as ggplot2-typed
figures using <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>.</p>
<p>It outlines which functions from <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> and the <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> universe are involved in
generating the visualizations.</p>
<p>The vignette further illustrates how the appearance of plots produced
with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
can be customized using <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions and extensions.</p>
<div class="section level4">
<h4 id="setup-example">Setup example<a class="anchor" aria-label="anchor" href="#setup-example"></a>
</h4>
<p>We begin by loading the required libraries and preparing the sequence
data to be visualized. The examples are based on data sets and examples
provided by the <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> package.</p>
<p><br></p>
<details><summary><strong>Click to show code for installing and loading required
packages</strong>
</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Load and download (if necessary) required packages ----</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span></span>
<span></span>
<span><span class="co">## Save package names as a vector of strings</span></span>
<span><span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"colorspace"</span>, <span class="co"># for using colors palettes</span></span>
<span>          <span class="st">"forcats"</span>, <span class="co"># for dropping unused factor levels with `fct_drop`</span></span>
<span>          <span class="st">"ggh4x"</span>, <span class="co"># for proportional panel sized with `force_panelsizes`</span></span>
<span>          <span class="st">"ggplot2"</span>, <span class="co"># for using all the ggplot2 functions </span></span>
<span>          <span class="st">"ggthemes"</span>, <span class="co"># for getting access to the canva_palettes</span></span>
<span>          <span class="st">"patchwork"</span>, <span class="co"># for working with plot types built with patchwork</span></span>
<span>          <span class="st">"purrr"</span>, <span class="co"># used in the grouped rplot example</span></span>
<span>          <span class="st">"TraMineR"</span><span class="op">)</span> <span class="co"># the ultimate sequence analysis suite</span></span>
<span></span>
<span></span>
<span><span class="co">## Install uninstalled packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">pkgs</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, </span>
<span>       <span class="va">install.packages</span>, repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"repos"</span><span class="op">)</span><span class="op">[</span><span class="st">"CRAN"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Load all packages to library and adjust options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Don't forget to load ggseqplot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://maraab23.github.io/ggseqplot/">ggseqplot</a></span><span class="op">)</span></span></code></pre></div>
</details><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span><span class="co">## Creating state sequence objects from example data sets ----</span></span>
<span><span class="co">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span></span>
<span><span class="co">## biofam data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">biofam</span><span class="op">)</span></span>
<span></span>
<span><span class="va">biofam.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parent"</span>, <span class="st">"Left"</span>, <span class="st">"Married"</span>, <span class="st">"Left+Marr"</span>,</span>
<span>                <span class="st">"Child"</span>, <span class="st">"Left+Child"</span>, <span class="st">"Left+Marr+Child"</span>, <span class="st">"Divorced"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">biofam.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">biofam</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span>, <span class="op">]</span>, <span class="fl">10</span><span class="op">:</span><span class="fl">25</span>, <span class="co"># we only use a subsample</span></span>
<span>                     labels <span class="op">=</span> <span class="va">biofam.lab</span>,</span>
<span>                     weights <span class="op">=</span> <span class="va">biofam</span><span class="op">$</span><span class="va">wp00tbgs</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## actcal data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">actcal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actcal.lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"&gt; 37 hours"</span>, <span class="st">"19-36 hours"</span>, <span class="st">"1-18 hours"</span>, <span class="st">"no work"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">actcal.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">actcal</span>,<span class="fl">13</span><span class="op">:</span><span class="fl">24</span>,</span>
<span>                     labels<span class="op">=</span><span class="va">actcal.lab</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ex1 data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">)</span></span>
<span><span class="va">ex1.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">seqdef</a></span><span class="op">(</span><span class="va">ex1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">13</span>, </span>
<span>                  weights<span class="op">=</span><span class="va">ex1</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> The default figure size in this document is
<code>fig.width=8, fig.height=4.94</code> <br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="technicalities">Technicalities<a class="anchor" aria-label="anchor" href="#technicalities"></a>
</h2>
<p>All functions in <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
follow a similar structure: they take a state sequence object—created
with <code><a href="https://rdrr.io/pkg/TraMineR/man/seqdef.html" class="external-link">TraMineR::seqdef</a></code>—as their starting point. The
functions either operate directly on the sequence data or use other <a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> functions, such as
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code>, to derive the information to be
visualized.</p>
<p>Internally, <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
reshapes the data into a tidy (long) format before plotting them with <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions. This reshaping
step is typically necessary for creating layered and faceted graphics in
the grammar of graphics framework.</p>
<p>The following example demonstrates this process using a state
distribution plot. First, we compute the cross-sectional state
distributions across the sequence positions:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">seqstatd</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [State frequencies]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; A 0.421 0.420 0.421 0.417 0.419  0.42  0.42  0.42  0.42 0.418 0.414 0.415</span></span>
<span><span class="co">#&gt; B 0.162 0.162 0.162 0.162 0.162  0.16  0.16  0.17  0.17 0.169 0.170 0.171</span></span>
<span><span class="co">#&gt; C 0.098 0.098 0.098 0.097 0.097  0.10  0.10  0.10  0.10 0.096 0.096 0.098</span></span>
<span><span class="co">#&gt; D 0.320 0.321 0.320 0.324 0.322  0.32  0.32  0.31  0.31 0.318 0.320 0.317</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    [Valid states]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; N  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000  2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    [Entropy index]</span></span>
<span><span class="co">#&gt;   jan00 feb00 mar00 apr00 may00 jun00 jul00 aug00 sep00 oct00 nov00 dec00</span></span>
<span><span class="co">#&gt; H   0.9   0.9   0.9   0.9   0.9   0.9   0.9  0.91  0.91   0.9  0.91  0.91</span></span></code></pre></div>
<p>When calling <code>ggseqdplot</code>, these distributional data are
internally reshaped into a long-format dataset, where each row
represents the (weighted) relative frequency of a specific state at a
specific sequence position.</p>
<p>For example, the <code>actcal.seq</code> data contain sequences of
length 12 with an alphabet of 4 states. The reshaped dataset used for
plotting will therefore consist of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>12</mn><mo>×</mo><mn>4</mn><mo>=</mo><mn>48</mn></mrow><annotation encoding="application/x-tex">12 \times 4 = 48</annotation></semantics></math>
rows. If a grouping variable is provided, the resulting dataset will
contain 48 rows per group. To inspect this internal data structure,
assign the plot output to an object. The resulting list object stores
the data as its first element (named <code>data</code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span>
<span><span class="va">dplot</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 6</span></span></span>
<span><span class="co">#&gt;    group state      k     x     value grouplab           </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1     &gt; 37 hours jan00 1     0.421 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1     &gt; 37 hours feb00 2     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1     &gt; 37 hours mar00 3     0.422 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1     &gt; 37 hours apr00 4     0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1     &gt; 37 hours may00 5     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1     &gt; 37 hours jun00 6     0.42  Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1     &gt; 37 hours jul00 7     0.422 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1     &gt; 37 hours aug00 8     0.420 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1     &gt; 37 hours sep00 9     0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1     &gt; 37 hours oct00 10    0.418 Rel. Freq. (n=2000)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 38 more rows</span></span></span></code></pre></div>
<p>Once the data are in the correct shape, <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
uses standard <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions to create the
visualizations. In the case of state distribution plots, for instance,
<code>ggseqdplot</code> renders stacked bar charts for each sequence
position using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code>.</p>
<p>The following table summarizes the core internal function calls for
the various plot types available in <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="22%">
<col width="56%">
</colgroup>
<thead><tr class="header">
<th align="left">ggseqplot function</th>
<th align="left">TraMineR function</th>
<th align="left">ggplot2 geoms and extensions</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>ggseqdplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code></td>
<td align="left">
<code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code><br>optional:
<code>geom_line</code>
</td>
</tr>
<tr class="even">
<td align="left"><code>ggseqeplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqstatd.html" class="external-link">TraMineR::seqstatd</a></code></td>
<td align="left"><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line</a></code></td>
</tr>
<tr class="odd">
<td align="left"><code>ggseqmsplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqmodst.html" class="external-link">TraMineR::seqmodst</a></code></td>
<td align="left"><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code></td>
</tr>
<tr class="even">
<td align="left"><code>ggseqmtplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqmeant.html" class="external-link">TraMineR::seqmeant</a></code></td>
<td align="left"><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar</a></code></td>
</tr>
<tr class="odd">
<td align="left"><code>ggseqtrplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code></td>
<td align="left"><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile</a></code></td>
</tr>
<tr class="even">
<td align="left"><code>ggseqiplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqformat.html" class="external-link">TraMineR::seqformat</a></code></td>
<td align="left"><code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code></td>
</tr>
<tr class="odd">
<td align="left"><code>ggseqfplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqtab.html" class="external-link">TraMineR::seqtab</a></code></td>
<td align="left">
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><a href="https://teunbrand.github.io/ggh4x/" target="_blank" class="external-link"><code>{ggh4x}</code></a> (for the axis labeling if group
has been specified)</td>
</tr>
<tr class="even">
<td align="left"><code>ggseqrplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqrep.html" class="external-link">TraMineR::seqrep</a></code></td>
<td align="left">
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel</a></code><br><a href="https://wilkelab.org/ggtext/" target="_blank" class="external-link"><code>{ggtext}</code></a> (for optional colored axis
labels)<br><a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> (to combine plots)</td>
</tr>
<tr class="odd">
<td align="left"><code>ggseqrfplot</code></td>
<td align="left"><code><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">TraMineR::seqrfplot</a></code></td>
<td align="left">
<code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_rect</a></code><br><code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">ggplot2::geom_boxplot</a></code><br><a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> (to combine plots)</td>
</tr>
</tbody>
</table>
<p>Most plots created with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
behave like regular ggplots. You can customize them by adding themes,
adjusting scales, or using other standard <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> syntax via
<code>+</code>.</p>
<p>Representative sequence plots and relative frequency sequence plots,
however, behave differently because they are composed of multiple
subplots which are arranged using the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library. The following
section illustrates how the appearance of the plots can be changed.
<br><br><br></p>
</div>
<div class="section level2">
<h2 id="changing-the-appearance-of-plots">Changing the appearance of plots<a class="anchor" aria-label="anchor" href="#changing-the-appearance-of-plots"></a>
</h2>
<div class="section level3">
<h3 id="the-default-case">The default case<a class="anchor" aria-label="anchor" href="#the-default-case"></a>
</h3>
<p>As mentioned above, most plots rendered by <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
are of class <code>c("gg", "ggplot")</code> and can be customized just
like any other plot created with <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a></p>
<div class="section level4">
<h4 id="example-1-state-distribution-plot">Example 1: State distribution plot<a class="anchor" aria-label="anchor" href="#example-1-state-distribution-plot"></a>
</h4>
<p>We begin with a simple state distribution plot using the sequence
object <code>actcal.seq</code>, without modifying the default
settings.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/dplot1-1.png" width="768"></p>
<p>Next, we demonstrate how to refine the plot using a variety of <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> functions and extensions. As
with any other <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> plot, the appearance of plots
generated with <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions can be extensively customized:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_discrete_sequential</span><span class="op">(</span><span class="st">"heat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"State distribution plot"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Alphabet"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">30</span>, margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">20</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-1-1.png" width="768"></p>
<p>In the following example, we use two <code>ggseqdplot</code> calls to
create plots of the same data, one with and one without weights. We also
display entropy lines (<code>geom_line</code>) and combine the two plots
using the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> package <span class="citation">(Pedersen, 2020)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save plot using weights</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, </span>
<span>                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Weighted data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save same plot without using weights</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqdplot.html">ggseqdplot</a></span><span class="op">(</span><span class="va">ex1.seq</span>, </span>
<span>                 with.entropy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unweighted data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arrange and refine plots using patchwork</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span> <span class="va">canva_palettes</span><span class="op">$</span><span class="va">`Fun and tropical`</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-2-transition-rate-plot">Example 2: Transition rate plot<a class="anchor" aria-label="anchor" href="#example-2-transition-rate-plot"></a>
</h4>
<p>In the next set of examples, we refine plots generated by
<code>ggseqtrplot</code>, which internally calls
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqtrate.html" class="external-link">TraMineR::seqtrate</a></code> to compute the transition rates between
states. These rates are returned in a symmetrical matrix and then
reshaped into long format within <code>ggseqtrplot</code> to be plotted
with <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">ggplot2::geom_tile</a></code>.</p>
<p>We begin with a basic example that visualizes transition rate
matrices for two groups defined by the sex variable The output is a
faceted plot visualizing two transition rate matrices of DSS sequence
data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, </span>
<span>            group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states A/B/C/D ...</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>In the second example, we add customizations and utilize once again
the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library to compose a figure
that compares the transition matrices of the same sequence data in STS
and DSS format.</p>
<p>We set <code>x_n.dodge = 2</code> to prevent overlapping x-axis
labels, reduce the font size of the value labels displayed within the
tiles (<code>labsize = 7</code>), and set <code>dss = FALSE</code> to
switch to the STS format.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, </span>
<span>                  dss <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  labsize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"STS Sequences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqtrplot.html">ggseqtrplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, </span>
<span>                  x_n.dodge <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  labsize <span class="op">=</span> <span class="fl">7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"DSS Sequences"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span>, <span class="st">"points"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] computing transition probabilities for states 0/1/2/3/4/5/6/7 ...</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>In contrast to the grouped plot above, the combined figure contains
duplicated y-axis labels and titles. These can be removed using standard
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> arguments:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                  hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-3-sequence-index-plots-of-illustrative-very-few-sequences">Example 3: Sequence index plots of illustrative (very few)
sequences<a class="anchor" aria-label="anchor" href="#example-3-sequence-index-plots-of-illustrative-very-few-sequences"></a>
</h4>
<p><a href="http://traminer.unige.ch" target="_blank" class="external-link"><code>{TraMineR}</code></a> offers two types of sequence
index plots: <code><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">TraMineR::seqiplot</a></code> for displaying a small
selection of sequences (typically no more than 10), and
<code><a href="https://rdrr.io/pkg/TraMineR/man/seqplot.html" class="external-link">TraMineR::seqIplot</a></code> for plotting the full set of sequences.
The former adds white space between the displayed sequences, making it
well suited for illustrative purposes—for example, when showcasing a few
hand-picked sequences in publications or teaching materials. While <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
does not provide built-in spacing between sequences, a similar effect
can be achieved with a small trick: by assigning each sequence to its
own group via the group argument, <code>ggseqiplot</code> uses
<code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap</a></code> to place each sequence in a separate
panel, thereby visually separating them.</p>
<p>In the example below, we display five sequences
(<code>biofam.seq[2:6,]</code>) as a faceted plot, where each sequence
forms its own group (<code>group = 1:5</code>) and is shown in a
separate panel arranged in a single column
(<code>facet_ncol = 1</code>). The remainder of the code applies visual
fine-tuning: group labels are moved to the left
(<code>strip.position = "left"</code>) and rotated
(<code>strip.text.y.left = element_text(angle = 0)</code>); superfluous
axis elements—such as y-axis labels
(<code>axis.text.y = element_blank()</code>), ticks
(<code>axis.ticks.y = element_blank()</code>), and the axis title
(<code>labs(y = NULL)</code>)—are removed; and the white space between
sequences is slightly reduced by adjusting vertical panel spacing
(<code>panel.spacing.y = unit(1.5, "lines")</code>).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot a subset of 5 sequences from biofam.seq</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">biofam.seq</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>,<span class="op">]</span>,</span>
<span>           group <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>           facet_ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           strip.position <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>           no.n <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           border <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           weighted <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.y.left <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>        panel.spacing.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-4-flipping-coordinates">Example 4: Flipping coordinates<a class="anchor" aria-label="anchor" href="#example-4-flipping-coordinates"></a>
</h4>
<p>Another way to adjust the appearance of plots rendered by <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
is to flip their coordinates—an approach commonly used in the <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a> ecosystem.</p>
<p>In the example below, we illustrate coordinate flipping for both a
mean time plot and a sequence index plot. For each plot type, we show
the default version followed by its flipped counterpart:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## default plot</span></span>
<span><span class="fu"><a href="../reference/ggseqmtplot.html">ggseqmtplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, no.n <span class="op">=</span> <span class="cn">TRUE</span>, error.bar <span class="op">=</span> <span class="st">"SE"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## flipped version</span></span>
<span><span class="fu"><a href="../reference/ggseqmtplot.html">ggseqmtplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, no.n <span class="op">=</span> <span class="cn">TRUE</span>, error.bar <span class="op">=</span> <span class="st">"SE"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-7-2.png" width="768"></p>
<p>While the flipped version above may be more in line with some users’
aesthetic preferences, flipping coordinates for sequence index plots is
a more opinionated design choice. Most researchers display time along
the horizontal axis. However, if you prefer time to <em>run</em>
vertically—bottom to top, as in Piccarreta and Lior <span class="citation">(Piccarreta &amp; Lior, 2010)</span>—this preference is
easily accommodated:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## default plot</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, sortv <span class="op">=</span> <span class="st">"from.end"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## flipped version</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, sortv <span class="op">=</span> <span class="st">"from.end"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-8-2.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-5-proportional-panel-sizes-for-grouped-sequence-plots">Example 5: Proportional panel sizes for grouped sequence plots<a class="anchor" aria-label="anchor" href="#example-5-proportional-panel-sizes-for-grouped-sequence-plots"></a>
</h4>
<p>A common use case—especially in the context of cluster analyses—is to
display grouped sequence plots with panel sizes that reflect the
relative size of each group. This makes the visualization more
informative, as it visually communicates the prevalence of each
group.</p>
<p>In the following example, we illustrate this approach using
<code>actcal$sex</code> as the grouping variable. As before, the
<code>group</code> argument is used to split the data into separate
panels arranged in a single column (<code>facet_ncol = 1</code>). To
scale the height of each panel proportionally to the group size, we
compute the relative frequencies using:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hghts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">fct_drop</span><span class="op">(</span><span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">actcal.seq</span><span class="op">)</span></span></code></pre></div>
<p>The <code>fct_drop()</code> function ensures that only those factor
levels actually present in the data are considered when tabulating group
sizes—this avoids reserving space for empty panels corresponding to
unused levels. We then pass the resulting proportions to
<code><a href="https://teunbrand.github.io/ggh4x/reference/force_panelsizes.html" class="external-link">ggh4x::force_panelsizes()</a></code> via the <code>rows</code>
argument. This function adjusts the panel heights accordingly, so that
larger groups occupy more vertical space in the plot. Finally, we reduce
the spacing between panels using
<code>theme(panel.spacing = unit(1, "lines"))</code> for a more compact
appearance.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## use ggh4x::force_panelsizes to get proportional panels</span></span>
<span><span class="fu"><a href="../reference/ggseqiplot.html">ggseqiplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, </span>
<span>           sortv <span class="op">=</span> <span class="st">"from.end"</span>, </span>
<span>           group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span>,</span>
<span>           facet_ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">force_panelsizes</span><span class="op">(</span>rows <span class="op">=</span> <span class="va">hghts</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="the-special-case-of-combined-plots">The special case of combined plots<a class="anchor" aria-label="anchor" href="#the-special-case-of-combined-plots"></a>
</h3>
<p>Two types of plots differ from the standard behavior of <a href="https://maraab23.github.io/ggseqplot/"><code>{ggseqplot}</code></a>
functions: they are composed by two subplots, which are arranged into a
single figure using the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library. Because of this
composition, their appearance cannot be adjusted in exactly the same way
as plots returned directly as <code>ggplot</code> objects. For more
details on the functionality and syntax of <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a>,<br>
we refer readers to the to the package documentation.</p>
<div class="section level4">
<h4 id="example-6-annotation-and-themes">Example 6: Annotation and themes<a class="anchor" aria-label="anchor" href="#example-6-annotation-and-themes"></a>
</h4>
<p>Despite their special structure, many aspects of combined <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> plots can still be
customized in ways familiar from <a href="https://ggplot2.tidyverse.org/" target="_blank" class="external-link"><code>{ggplot2}</code></a>. For example, themes and plot
annotations can be modified using the <code>&amp;</code> operator
(instead of <code>+</code>, which is used for standard
<code>ggplot</code> objects).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## compute dissimilarity matrix required for plot</span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">biofam.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 100 sequences with 8 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 8x8 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 76 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 16/16</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.017 secs</span></span>
<span></span>
<span><span class="co">## Relative Frequency Sequence Plot</span></span>
<span><span class="co">## default version</span></span>
<span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> </span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## adjusted version</span></span>
<span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                    vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relative Frequency Sequence Plot"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-11-2.png" width="768"></p>
<p>If you want to manipulate the appearance of a specific subplot,
however, the default approach might not work as expected. For example,
if you aim to change the x-axis labels of the index plot, the following
code will <em>not</em> yield the intended result:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>In this case, <code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete()</a></code> will be applied to the
boxplot (i.e., the last plot constructed in the combined object), not to
the index plot. This behavior arises because the <code>+</code> operator
affects the final <code>ggplot</code> object passed into the patchwork
layout.</p>
<p>To adjust the appearance of individual subplots within a combined
plot, you need to first save the composite plot object, access its
components, and then modify them individually before reassembling the
full plot.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## save &amp; view original plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span>, diss <span class="op">=</span> <span class="va">diss</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.367766</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.268049, p-value: 1.655783e-06</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## change appearance of sub-plots</span></span>
<span></span>
<span><span class="co">## first component: index plot</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="co">## second component: boxplot</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Changed title"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## adjusted plot</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-13-2.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-7-the-complex-case-of-grouped-rplots">Example 7: The complex case of grouped rplots<a class="anchor" aria-label="anchor" href="#example-7-the-complex-case-of-grouped-rplots"></a>
</h4>
<p>Things become a bit more complex when working with grouped
representative sequence plots. In such plots, each group contributes two
subplots: one showing information on the “quality” of the representative
sequences (e.g., frequency, coverage, or centrality), and another
displaying the corresponding index plots.</p>
<p>If you want to adjust the x-axis labels, for example, you must
specifically target the index plots, which appear in the second row of
the combined layout. The subplots are arranged by row, so for a
two-group example, the index plots correspond to subplots 3 and 4.</p>
<p>To apply the desired changes, you need to extract these components,
modify them as needed, and then re-plot the final figure.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Compute a pairwise dissimilarity matrix</span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">actcal.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 2000 sequences with 4 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 4x4 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 186 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 12/12</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.277 secs</span></span>
<span></span>
<span><span class="co">## original plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrplot.html">ggseqrplot</a></span><span class="op">(</span><span class="va">actcal.seq</span>, </span>
<span>                diss <span class="op">=</span> <span class="va">diss</span>,</span>
<span>                nrep <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                group <span class="op">=</span> <span class="va">actcal</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] number of objects (sum of weights): 884</span></span>
<span><span class="co">#&gt;  [&gt;] max. distance: 24</span></span>
<span><span class="co">#&gt;  [&gt;] neighborhood radius: 2.4</span></span>
<span><span class="co">#&gt;  [&gt;] 3 representative(s) selected</span></span>
<span><span class="co">#&gt;  [&gt;] 80 distinct sequence(s)</span></span>
<span><span class="co">#&gt;  [&gt;] number of objects (sum of weights): 1116</span></span>
<span><span class="co">#&gt;  [&gt;] max. distance: 24</span></span>
<span><span class="co">#&gt;  [&gt;] neighborhood radius: 2.4</span></span>
<span><span class="co">#&gt;  [&gt;] 3 representative(s) selected</span></span>
<span><span class="co">#&gt;  [&gt;] 144 distinct sequence(s)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## adjusted sequence index subplots</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-14-2.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="example-8-what-about-grouped-rfplots">Example 8: What about grouped rfplots?<a class="anchor" aria-label="anchor" href="#example-8-what-about-grouped-rfplots"></a>
</h4>
<p>Grouped representative frequency plots are currently <strong>not
implemented</strong> in <code>ggseqrfplot</code> and must be assembled
<em>manually</em> using the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> library.</p>
<p>In the following example, we:</p>
<ol style="list-style-type: decimal">
<li>Create rfplots for each group (here: “Men” and “Women”),<br>
</li>
<li>Slightly <em>misuse</em> <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a>’s tag annotation to assign
group-specific labels to the first plot in each row,</li>
<li>Remove the legend from the upper plot panel (<code>p$man</code>),
and</li>
<li>Combine the two plots in a final stacked figure using a nested
patchwork layout.</li>
</ol>
<p>Technically, the resulting plot is a nested patchwork plot. According
to the <a href="https://patchwork.data-imaginist.com/index.html" target="_blank" class="external-link"><code>{patchwork}</code></a> documentation,</p>
<blockquote>
<p>[i]t is important to note that plot annotations only have an effect
on the top-level patchwork. Any annotation added to nested patchworks
are (currently) lost. If you need to have annotations for a nested
patchwork you’ll need to wrap it in wrap_elements() with the side-effect
that alignment no longer works.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html#titles-subtitles-and-captions" class="external-link uri"&gt;https://patchwork.data-imaginist.com/articles/guides/annotation.html#titles-subtitles-and-captions&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
</blockquote>
<p>For this reason, we refrained from using
<code><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">patchwork::plot_annotation</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::ggtitle</a></code>
to add group titles and used plot tags instead.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">diss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TraMineR/man/seqdist.html" class="external-link">seqdist</a></span><span class="op">(</span><span class="va">biofam.seq</span>, method <span class="op">=</span> <span class="st">"LCS"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] 100 sequences with 8 distinct states</span></span>
<span><span class="co">#&gt;  [&gt;] creating a 'sm' with a substitution cost of 2</span></span>
<span><span class="co">#&gt;  [&gt;] creating 8x8 substitution-cost matrix using 2 as constant value</span></span>
<span><span class="co">#&gt;  [&gt;] 76 distinct  sequences</span></span>
<span><span class="co">#&gt;  [&gt;] min/max sequence lengths: 16/16</span></span>
<span><span class="co">#&gt;  [&gt;] computing distances using the LCS metric</span></span>
<span><span class="co">#&gt;  [&gt;] elapsed time: 0.016 secs</span></span>
<span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="va">biofam</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">600</span>, <span class="st">"sex"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">map2</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, <span class="co"># input x</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span>, <span class="co"># input y</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggseqrfplot.html">ggseqrfplot</a></span><span class="op">(</span><span class="va">biofam.seq</span><span class="op">[</span><span class="va">sex</span> <span class="op">==</span> <span class="va">x</span>,<span class="op">]</span>,</span>
<span>                     diss <span class="op">=</span> <span class="va">diss</span><span class="op">[</span><span class="va">sex</span> <span class="op">==</span> <span class="va">x</span>,<span class="va">sex</span> <span class="op">==</span> <span class="va">x</span><span class="op">]</span>,</span>
<span>                     k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span>    <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>tag <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.5448432</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 3.408139, p-value: 0.003407164</span></span>
<span><span class="co">#&gt;  [&gt;] Using k=12 frequency groups with grp.meth='prop'</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-R2: 0.5263291</span></span>
<span><span class="co">#&gt;  [&gt;] Pseudo/medoid-based-F statistic: 5.687386, p-value: 4.537004e-06</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">man</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span><span class="op">$</span><span class="va">woman</span></span></code></pre></div>
<p><img src="ggseqplot_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<p>This approach gives you full control over the layout and design of
grouped rfplots, even in the absence of direct support in the
<code>ggseqrfplot</code> function.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-brzinsky-fay2014" class="csl-entry">
Brzinsky-Fay, C. (2014). <em>Graphical Representation of Transitions and
Sequences</em> (P. Blanchard, F. Bühlmann, &amp; J.-A. Gauthier, Eds.;
pp. 265–284). Springer. <a href="https://doi.org/10.1007/978-3-319-04969-4_14" class="external-link">https://doi.org/10.1007/978-3-319-04969-4_14</a>
</div>
<div id="ref-fasang2014" class="csl-entry">
Fasang, A. E., &amp; Liao, T. F. (2014). Visualizing Sequences in the
Social Sciences: Relative Frequency Sequence Plots. <em>Sociological
Methods &amp; Research</em>, <em>43</em>(4), 643–676. <a href="https://doi.org/10.1177/0049124113506563" class="external-link">https://doi.org/10.1177/0049124113506563</a>
</div>
<div id="ref-gabadinho2011" class="csl-entry">
Gabadinho, A., Ritschard, G., Müller, N. S., &amp; Studer, M. (2011).
Analyzing and Visualizing State Sequences in R with TraMineR.
<em>Journal of Statistical Software</em>, <em>40</em>(4), 1–37. <a href="https://doi.org/10.18637/jss.v040.i04" class="external-link">https://doi.org/10.18637/jss.v040.i04</a>
</div>
<div id="ref-pedersen2020" class="csl-entry">
Pedersen, T. L. (2020). <em>Patchwork: The composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork" class="external-link">https://CRAN.R-project.org/package=patchwork</a>
</div>
<div id="ref-piccarreta2010" class="csl-entry">
Piccarreta, R., &amp; Lior, O. (2010). Exploring sequences: A graphical
tool based on multi-dimensional scaling: <span>Exploring
Sequences</span>. <em>Journal of the Royal Statistical Society: Series A
(Statistics in Society)</em>, <em>173</em>(1), 165–184. <a href="https://doi.org/10.1111/j.1467-985X.2009.00606.x" class="external-link">https://doi.org/10.1111/j.1467-985X.2009.00606.x</a>
</div>
<div id="ref-raab2022" class="csl-entry">
Raab, M., &amp; Struffolino, E. (2022). <em>Sequence analysis</em> (Vol.
190). SAGE. <a href="https://sa-book.github.io/" class="external-link">https://sa-book.github.io/</a>
</div>
<div id="ref-wickham2016" class="csl-entry">
Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>
(2nd ed. 2016). Springer. <a href="https://doi.org/10.1007/978-3-319-24277-4" class="external-link">https://doi.org/10.1007/978-3-319-24277-4</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://marcelraab.de" class="external-link">Marcel Raab</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
